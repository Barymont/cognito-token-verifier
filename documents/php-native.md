### This is an example of implementation in PHP native (No frameworks)

1. Install the library on your project check the [README](../README.md) file, in the section [Installation](../README.md#installation)

2. Add new enviroment variables.

```CONF
    AWS_COGNITO_USER_POOL_ID=us-east-1_XXXXXXXXX
    AWS_COGNITO_APP_CLIENTS_ALLOWED_IDS=XXXXXXXXXXXXXXXXXXXXXXXXXX,XXXXXXXXXXXXXXXXXXXXXXXXXX
```

**AWS_COGNITO_USER_POOL_ID** Is the ID of the user pool in Cognito, you can find it in the Cognito console, in the section "General settings" of your user pool.
**AWS_COGNITO_APP_CLIENTS_ALLOWED_IDS** Is a comma separated list of the Client IDs of the applications that are allowed to use the tokens, you can find it in the Cognito console, in the section "App clients" of your user pool. This is a security measure to avoid that a token generated by one application is used in another application. If you don't want to use this security measure, you can set this variable to an empty string.

3. Usage example:

```PHP

use CognitoTokenVerifier\Application\Login;
use CognitoTokenVerifier\Application\Verifier;
use CognitoTokenVerifier\Infrastructure\FromFileKeysRepository;

/**
 * This is an example of login to Cognito, this library its not created on purpose to obtain the token, demo purposes only.
 */
$token = (new Login())->__invoke(
    'https://{userPoolName}.auth.{userPoolRegion}.amazoncognito.com/oauth2/token',
    'COGNITO_APP_ID',
    'COGNITO_APP_SECRET',
);

/**
 * This is an example of verification of the token.
 * In this example we are using the FromFileKeysRepository class to obtain the keys from a file or URL, you can use your own implementation of the KeysRepository interface to obtain the keys from a database or from a cache.
 * With this example we are verifying that the token is valid and that the user has the required scopes to access the resource.
 */
$verifier = (new Verifier(
    $_ENV['AWS_COGNITO_USER_POOL_ID'],
    new FromFileKeysRepository('https://cognito-idp.{userPoolRegion}.amazonaws.com/{userPoolId}/.well-known/jwks.json'), // You can use your own implementation of the KeysRepository interface
    $_ENV['AWS_COGNITO_APP_CLIENTS_ALLOWED_IDS'],
))->__invoke(
    $token['access_token'],
    ['https://service.api.com/delete', 'https://service.api.com/read'],
);

```
